<?xml version="1.0" encoding="UTF-8"?>
<ViewConfig>
  <Arguments/>
  <Context/>
  <Model>
    <DataType name="Document">
      <Property name="creationType">com.bstek.cms.orm.Document</Property>
      <PropertyDef name="id">
        <Property></Property>
        <Property name="label">ID</Property>
      </PropertyDef>
      <PropertyDef name="name">
        <Property></Property>
        <Property name="label">标题</Property>
      </PropertyDef>
      <PropertyDef name="creator">
        <Property></Property>
        <Property name="label">创建人</Property>
      </PropertyDef>
      <PropertyDef name="createDate">
        <Property name="dataType">Date</Property>
        <Property name="label">创建时间</Property>
      </PropertyDef>
      <PropertyDef name="startDate">
        <Property name="dataType">Date</Property>
        <Property name="label">有效期</Property>
      </PropertyDef>
      <PropertyDef name="endDate">
        <Property name="dataType">Date</Property>
        <Property name="label">至</Property>
      </PropertyDef>
      <PropertyDef name="content">
        <Property></Property>
        <Property name="label">内容</Property>
      </PropertyDef>
      <PropertyDef name="type">
        <Property></Property>
        <Property name="label">类型</Property>
      </PropertyDef>
      <PropertyDef name="deptId">
        <Property></Property>
        <Property name="label">部门</Property>
      </PropertyDef>
      <PropertyDef name="order">
        <Property name="dataType">Integer</Property>
        <Property name="label">序号</Property>
      </PropertyDef>
      <PropertyDef name="programaName">
        <Property></Property>
        <Property name="label">所属栏目名称</Property>
      </PropertyDef>
      <PropertyDef name="updateDate">
        <Property name="dataType">Date</Property>
        <Property name="label">修改时间</Property>
      </PropertyDef>
      <PropertyDef name="top">
        <Property name="dataType">boolean</Property>
        <Property name="label">置顶</Property>
      </PropertyDef>
      <PropertyDef name="browseNumber">
        <Property name="dataType">Integer</Property>
        <Property name="label">浏览次数</Property>
      </PropertyDef>
      <PropertyDef name="securityLevel">
        <Property name="label">密级</Property>
        <Property name="mapping">
          <Property name="mapValues">${dict.items(&quot;MJ&quot;)}</Property>
          <Property name="valueProperty">value</Property>
          <Property name="keyProperty">key</Property>
        </Property>
      </PropertyDef>
      <PropertyDef name="status">
        <Property name="label">状态</Property>
        <Property name="mapping">
          <Property name="mapValues">${dict.items(&quot;DS&quot;)}</Property>
          <Property name="valueProperty">value</Property>
          <Property name="keyProperty">key</Property>
        </Property>
      </PropertyDef>
    </DataType>
  </Model>
  <View>
    <ClientEvent name="onReady">/*&#xD;
if (localStorage.pagecount) {&#xD;
    localStorage.pagecount = Number(localStorage.pagecount) + 1;&#xD;
} else {&#xD;
    localStorage.pagecount = 1;&#xD;
}&#xD;
alert(localStorage.pagecount);&#xD;
*/&#xD;
&#xD;
</ClientEvent>
    <Property name="packages">font-awesome,colors</Property>
    <DataSet id="dsDocument">
      <ClientEvent name="beforeLoadData">//var name = decodeURI(&quot;${param.name}&quot;);&#xD;
self.set(&quot;parameter&quot;, &quot;${param.name}&quot;);&#xD;
&#xD;
</ClientEvent>
      <ClientEvent name="onLoadData" signature="self,arg,title,data,ajaxAction,count">var param = {&#xD;
	docId: null,&#xD;
	browseNumber: null&#xD;
};&#xD;
var doc = self.getData(&quot;#&quot;);&#xD;
&#xD;
title.set(&quot;text&quot;, doc.get(&quot;name&quot;));&#xD;
&#xD;
if (doc.get(&quot;browseNumber&quot;) == null) {	&#xD;
	data.set(&quot;text&quot;, &quot; 发布人  : &quot; + doc.get(&quot;creator&quot;)&#xD;
		 + &quot; 发表日期  : &quot; + doc.get(&quot;createDate&quot;).formatDate(&quot;Y-m-d&quot;)&#xD;
	);&#xD;
	count.set(&quot;text&quot;, &quot;浏览次数  : &quot; + 1);&#xD;
	&#xD;
	param.browseNumber = 1;&#xD;
} else {&#xD;
	var number = doc.get(&quot;browseNumber&quot;) + 1;&#xD;
	&#xD;
	data.set(&quot;text&quot;, &quot; 发布人  : &quot; + doc.get(&quot;creator&quot;)&#xD;
		 + &quot; 发表日期  : &quot; + doc.get(&quot;createDate&quot;).formatDate(&quot;Y-m-d&quot;)&#xD;
	);&#xD;
	count.set(&quot;text&quot;, &quot;浏览次数  : &quot; + number);&#xD;
	&#xD;
	param.browseNumber = number;&#xD;
}&#xD;
&#xD;
param.docId = doc.get(&quot;id&quot;);&#xD;
ajaxAction.set(&quot;parameter&quot;, param).execute();&#xD;
</ClientEvent>
      <Property name="dataProvider">portalController#loadDocumentByName</Property>
      <Property name="dataType">[Document]</Property>
      <Property name="loadMode">onReady</Property>
    </DataSet>
    <Container layout="hbox">
      <Property name="style">
        <Property name="border">1px solid</Property>
        <Property name="border-color">#d0d0d0</Property>
      </Property>
      <Property name="height">85</Property>
      <Label>
        <Property name="exClassName">fa fa-language</Property>
        <Property name="text">  内容管理系统</Property>
        <Property name="style">
          <Property name="key"></Property>
        </Property>
      </Label>
      <Label>
        <Property name="text">  正文</Property>
        <Property name="exClassName">fa fa-globe violet-text</Property>
      </Label>
      <TextEditor>
        <ClientEvent name="onKeyDown">if (self.get(&quot;text&quot;)) {&#xD;
	if (arg.keyCode === 13) {&#xD;
		window.open(&quot;com.bstek.cms.web.portal.search.SearchResult.d?value=&quot; + self.get(&quot;text&quot;));&#xD;
	}	&#xD;
}</ClientEvent>
        <Property name="width">500</Property>
        <Property name="blankText">按标题搜索...</Property>
        <Property name="exClassName">fa fa-search</Property>
      </TextEditor>
      <Label>
        <Property name="exClassName">fa fa-th</Property>
      </Label>
      <Button>
        <ClientEvent name="onClick">if (self.get(&quot;caption&quot;) == &quot; 登 陆&quot;) {&#xD;
	window.open(&quot;bdf3.security.ui.view.Login.d&quot;);&#xD;
} else {&#xD;
	dorado.MessageBox.confirm(&quot;确认退出？&quot;, function() {&#xD;
		window.location.href = &quot;${configure['bdf3.logoutPath']}&quot;;		&#xD;
	});&#xD;
}&#xD;
</ClientEvent>
        <ClientEvent name="onReady">var username = &quot;${loginUsername}&quot;;&#xD;
if (username) {&#xD;
	self.set(&quot;caption&quot;, username);&#xD;
} else {&#xD;
	self.set(&quot;caption&quot;, &quot; 登 陆&quot;);&#xD;
}</ClientEvent>
        <Property name="caption">登陆</Property>
        <Property name="style">
          <Property name="font-weight">bold</Property>
        </Property>
      </Button>
    </Container>
    <Label id="title">
      <Property name="style">
        <Property name="font-size">30px</Property>
        <Property name="margin-top">80px</Property>
        <Property name="font-weight">bold</Property>
        <Property name="color">#3C3C3C</Property>
      </Property>
      <Property name="height">60</Property>
    </Label>
    <Label id="data">
      <Property name="style">
        <Property name="font-size">16px</Property>
      </Property>
    </Label>
    <Label id="count">
      <Property name="style">
        <Property name="font-size">16px</Property>
      </Property>
    </Label>
    <Container>
      <Property name="width">1200</Property>
      <Property name="style">
        <Property name="margin-left">19%</Property>
      </Property>
      <Property name="height">0</Property>
      <UEditor layoutConstraint="left">
        <ClientEvent name="onCreate">dorado.ueditor.registerMode(&quot;custom&quot;, []);&#xD;
</ClientEvent>
        <Property name="mode">custom</Property>
        <Property name="readOnly">true</Property>
        <Property name="dataSet">dsDocument</Property>
        <Property name="property">content</Property>
        <Property name="defaultFontSize">22px</Property>
        <Property name="width">650px</Property>
        <Property name="height">2000</Property>
      </UEditor>
      <BlockView id="bvNumber">
        <ClientEvent name="onRenderBlock">$(arg.dom).empty();&#xD;
var $h = $(&quot;&lt;h4 class='ex header'>&lt;i class='fa fa-shield'>&lt;/i> &quot;+ arg.data.type +&quot;&lt;/h4>&quot;).appendTo(arg.dom);&#xD;
var items = arg.data.items || [];&#xD;
var $ul = $(&quot;&lt;ul class='ex items'>&lt;/ul>&quot;).appendTo(arg.dom);&#xD;
items.each(function(item){		&#xD;
	var $li = $(&quot;&lt;li>&quot;+ item.name +&quot;&lt;/li>&quot;).appendTo($ul);	&#xD;
	$li.click(function() {		&#xD;
		window.location.href = &quot;com.bstek.cms.web.portal.ContentTemplate.d?name=&quot; + item.name;&#xD;
	});&#xD;
});</ClientEvent>
        <Property name="lineSize">1</Property>
        <Property name="blockWidth">430</Property>
        <Property name="blockHeight">2000</Property>
      </BlockView>
    </Container>
    <AjaxAction id="ajaxAction">
      <ClientEvent name="onSuccess" signature="self,arg,bvNumber">var items = [];&#xD;
var type = &quot;点击量排行榜&quot;;&#xD;
&#xD;
var item = {&#xD;
	type: type,&#xD;
	items: arg.result&#xD;
};&#xD;
items.push(item);&#xD;
&#xD;
bvNumber.set(&quot;items&quot;, items);&#xD;
</ClientEvent>
      <Property name="service">portalController#saveBrowseNumber</Property>
    </AjaxAction>
  </View>
</ViewConfig>
